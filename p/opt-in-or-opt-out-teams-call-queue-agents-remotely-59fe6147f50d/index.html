<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="This is an interesting one. First of all, letâ€™s give credits where theyâ€™re due. This blog post is inspired by this post by the greatâ€¦">
<title>Opt In or Opt Out Teams Call Queue Agents Remotely</title>

<link rel='canonical' href='https://heusser.pro/p/opt-in-or-opt-out-teams-call-queue-agents-remotely-59fe6147f50d/'>

<link rel="stylesheet" href="/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css"><meta property='og:title' content="Opt In or Opt Out Teams Call Queue Agents Remotely">
<meta property='og:description' content="This is an interesting one. First of all, letâ€™s give credits where theyâ€™re due. This blog post is inspired by this post by the greatâ€¦">
<meta property='og:url' content='https://heusser.pro/p/opt-in-or-opt-out-teams-call-queue-agents-remotely-59fe6147f50d/'>
<meta property='og:site_name' content='HEUSSER.PRO'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2022-03-24T21:10:13&#43;00:00'/><meta property='article:modified_time' content='2022-03-24T21:10:13&#43;00:00'/>
<meta name="twitter:title" content="Opt In or Opt Out Teams Call Queue Agents Remotely">
<meta name="twitter:description" content="This is an interesting one. First of all, letâ€™s give credits where theyâ€™re due. This blog post is inspired by this post by the greatâ€¦">
    <link rel="shortcut icon" href="/favicon.png" />

    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "kozb6q2xjn");
    </script>    

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_fe2816fc44d850d2.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ðŸ«¡</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">HEUSSER.PRO</a></h1>
            <h2 class="site-description">Martin Heusser | M365 MVP</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/mozziemozz'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://x.com/@mozzeph'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about-me/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About Me</span>
            </a>
        </li>
        
        
        <li >
            <a href='/support-me/' >
                
                
                
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-cup"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 11h14v-3h-14z" /><path d="M17.5 11l-1.5 10h-8l-1.5 -10" /><path d="M6 8v-1a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v1" /><path d="M15 5v-2" /></svg>
                
                <span>Support Me</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/imprint/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-info-circle" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0" /><path d="M12 9h.01" /><path d="M11 12h1v4h1" /></svg>
                
                <span>Imprint</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li>
      <ol>
        <li>
          <ol>
            <li><a href="#disclaimer">Disclaimer</a></li>
            <li><a href="#whats-this-aboutagain">Whatâ€™s this aboutÂ again?</a></li>
            <li><a href="#changing-opt-in-status-as-auser">Changing opt in status as aÂ user</a></li>
            <li><a href="#im-an-admin-why-cant-i-change-the-damn-opt-instatus">Iâ€™m an Admin, why canâ€™t I change the damn opt inÂ status?</a></li>
          </ol>
        </li>
        <li><a href="#how-can-we-at-least-do-it-as-the-user-but-remotely">How can we at least do it as the user, but remotely?</a>
          <ol>
            <li><a href="#prerequisites">Prerequisites</a></li>
            <li><a href="#how-the-scriptworks">How the scriptÂ works</a></li>
            <li><a href="#script-modes">Script modes</a></li>
            <li><a href="#okbut-how-do-we-opt-a-userout">Okâ€Šâ€”â€ŠBut how do we opt a userÂ out!?</a></li>
            <li><a href="#script">Script</a></li>
            <li><a href="#conclusion">Conclusion</a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/microsoft-teams/" >
                Microsoft Teams
            </a>
        
            <a href="/categories/proof-of-concept/" >
                Proof of Concept
            </a>
        
            <a href="/categories/microsoft-graph/" >
                Microsoft Graph
            </a>
        
            <a href="/categories/powershell/" style="background-color: #141e2c; color: #fff;">
                PowerShell
            </a>
        
            <a href="/categories/automation/" >
                Automation
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/opt-in-or-opt-out-teams-call-queue-agents-remotely-59fe6147f50d/">Opt In or Opt Out Teams Call Queue Agents Remotely</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            This is an interesting one. First of all, letâ€™s give credits where theyâ€™re due. This blog post is inspired by this post by the greatâ€¦
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Mar 24, 2022</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    6 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p>This is an interesting one. First of all, letâ€™s give credits where theyâ€™re due. This blog post is inspired by <a class="link" href="https://alexholmeset.blog/2021/12/13/microsoft-teams-speed-dial-contacts-provisioning/"  target="_blank" rel="noopener"
    >this post</a> by the great <a class="link" href="https://twitter.com/AlexHolmeset"  target="_blank" rel="noopener"
    >Alexander Holmeset.</a></p>
<p>The PowerShell code to generate the TOTP is forked from this <a class="link" href="https://github.com/ecspresso/TOTPPowerShellModule"  target="_blank" rel="noopener"
    >repo</a>. And the code from this repo is from this <a class="link" href="https://gist.github.com/jonfriesen/234c7471c3e3199f97d5"  target="_blank" rel="noopener"
    >gist</a>.</p>
<p>The code to create the interactive sign in window and to get the token is based of <a class="link" href="https://docs.microsoft.com/en-us/answers/questions/491498/invoke-webrequest-to-get-access-token.html"  target="_blank" rel="noopener"
    >this example</a>.</p>
<h4 id="disclaimer">Disclaimer
</h4><p>Before we get into it, I should probably add a disclaimer that this is a proof of concept, at best. You should not use it in production as it uses some bad security practices (like sharing a user&rsquo;s password). For real. Donâ€™t say I didnâ€™t warn you.</p>
<h4 id="whats-this-aboutagain">Whatâ€™s this aboutÂ again?
</h4><p>However, being able to remotely change the opt in status of call queue agents seems to be quite a big ask from several Microsoft Teams admins and customers, so I decided to publish this piece anyway.</p>
<h4 id="changing-opt-in-status-as-auser">Changing opt in status as aÂ user
</h4><p>Can the opt in status of a user be changed as an admin? The answer is both yes and no. You canâ€™t do it in any delegated way if thatâ€™s what youâ€™re asking. You will need the userâ€™s credentials.</p>
<p>If youâ€™re a Teams User which is also a call queue agent, there are numerous ways to change your own opt in status for call queues. That is, if your admin allows opting out of queues of course. Letâ€™s go through them.</p>
<ul>
<li>From Teams Desktop Client Settings</li>
<li>From a Teams Voice Enabled Channel</li>
<li>From Teams Web Client Settings</li>
<li>From Teams Certified Desk Phones</li>
<li>From Teams Mobile Apps (Android / iOS)</li>
<li>From the good old <a class="link" href="https://aka.ms/cqsettings"  target="_blank" rel="noopener"
    >https://aka.ms/cqsettings</a></li>
</ul>
<h4 id="im-an-admin-why-cant-i-change-the-damn-opt-instatus">Iâ€™m an Admin, why canâ€™t I change the damn opt inÂ status?
</h4><p>From a Teams PowerShell session, we can only view the opt in status of a queueâ€™s agents but not change it.</p>
<p>(Get-CsCallQueue -Identity xxxxxxxx-f74b-46bb-9743-xxxxxxxxxxxx).Agents</p>
<p>This will spit out something like this.</p>
<p>ObjectId                             OptIn<br>
-&mdash;&mdash;-                             &mdash;&ndash;<br>
xxxxxxxx-4d28-4246-9c08-xxxxxxxxxxxx  True<br>
xxxxxxxx-8bae-419d-a4eb-xxxxxxxxxxxx  True<br>
xxxxxxxx-49db-40ee-9d05-xxxxxxxxxxxx False</p>
<p>Every attempt to change the returned PowerShell object failed. Miserably.</p>
<h3 id="how-can-we-at-least-do-it-as-the-user-but-remotely">How can we at least do it as the user, but remotely?
</h3><p>Similar to Alexâ€™s approach of creating Teams Contacts from CLI we also have to acquire a user token to be able to change the opt in status of a user by CLI.</p>
<p>In his scenario, heâ€™s mainly thinking about new users or even accounts which are used to sign into common area phones which might not be MFA enabled yet. In our case this might look different because we want to be able to alter the opt in state of already working staff.</p>
<p>At first, I also tried to use the AAD Internals PowerShell Module to receive a user token. In this case, however, it turned out to be much more complicated. When a user opens the Calls settings page in Teams, another token is requested from a different issuing service than the one which is used to access all the other features in Teams.</p>
<p>After a long night of googling and binging (yes, I was this desperate) I finally was able to get a working token by modifying the example from the Docs Q&amp;A which is linked in the intro of this article.</p>
<h4 id="prerequisites">Prerequisites
</h4><p><strong>Letâ€™s get one thing straight. This approach ONLY works if you know the password of the user and / or the user agrees to share their password or even an MFA secret with you.</strong></p>
<p>Iâ€™m thinking of the following scenario: we want to be able to automatically and remotely opt in and opt out agents of call queues based on various criteria such as working schedules etc.</p>
<p>To have at least some kind of security, my script is encrypting the password and the MFA secret before itâ€™s saved to the disk. Once theyâ€™re encrypted, they can only be decrypted by the same user account and the same Windows system which was used to encrypt them.</p>
<p>Why do we need to save the password to disk, when itâ€™s an interactive login process anyway? Well, if you want to automate it by any means, we can use SendKeys to emulate a user&rsquo;s keystrokes. To be completely honest, I only went so far because I wanted to see for myself if I can get it workingâ€¦</p>
<h4 id="how-the-scriptworks">How the scriptÂ works
</h4><p>The script needs a few parameters to work. We need to provide a user principal name, a user object Id and a call queue Id.</p>
<p>It will then check the current directory for two or three files depending on whether the -MFA switch is used.</p>
<p>You will be prompted to enter the password and the MFA secret if these files do not already exist. The token will be saved to a file once youâ€™ve successfully logged in and acquired one. If the token is expired (happens every few hours or so), you will be prompted for credentials again and the token inside the file will be replaced with the new one. Since we also saved the password to disk, you do not need to enter the password again. The script will decrypt and enter the password by emulating automated keystrokes automatically.</p>
<h4 id="script-modes">Script modes
</h4><p>The script features a -QueryStatusOnly switch, which will only check if the user is opted in or out of a queue. This will not change anything.</p>
<p>For the sake of simplicity, Iâ€™ve already stored the values of $UserId, $CallQueueId and $UserName as default values for the parameters. Of course, you can pass your own values if you call the script yourself.</p>
<p>In this video, you can see how the username and password are automatically entered, which will ultimately get us the token we need to call the API and query the userâ€™s opt in status.</p>
<p>If we run the same thing again, we will already have a valid token.</p>
<p>Now letâ€™s take a look at an MFA enabled user. For this, we use the optional -MFA switch. Besides the password, this will also prompt us for the MFA secret. The script then pulls down the PowerShell Script from GitHub and uses itâ€™s code to do some magic and generate the TOTP from the secret.</p>
<h4 id="okbut-how-do-we-opt-a-userout">Okâ€Šâ€”â€ŠBut how do we opt a userÂ out!?
</h4><p>Since we can already see the opt in status of members either in Voice Enabled Channels or via PowerShell this is nothing new. Letâ€™s opt a user out already!</p>
<h4 id="script">Script
</h4><p>Hereâ€™s the script. Please notice that sometimes, activating the AAD Login Window does not always work, so you might have to cancel and run it again. For me, it usually worked the second time I ran the script.</p>
<script src="https://gist.github.com/mozziemozz/ce70f39f720bf17632f60a3d6b1be110.js"></script>

<p>Hereâ€™s an example of running the script with parameters.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="p">.\</span><span class="n">CallQueueOptInOptOutGist</span><span class="p">.</span><span class="py">ps1</span> <span class="n">-UserId</span> <span class="s2">&#34;xxxxxxxx-8bae-419d-a4eb-xxxxxxxxxxxx&#34;</span> <span class="n">-UserName</span> <span class="s2">&#34;user@domain.com&#34;</span> <span class="n">-CallQueueId</span> <span class="s2">&#34;xxxxxxxx-f74b-46bb-9743-xxxxxxxxxxxx&#34;</span> <span class="n">-Action</span> <span class="n">OptOut</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="conclusion">Conclusion
</h4><p>Even though this method uses some real dirty tricks it still getâ€™s the job done. Well, kind of, at least. I really hope that Microsoft will add the functionality to allow Queue managers to remotely opt in or opt out their agents in a more practical way. Itâ€™s a real pity that not even the new <a class="link" href="https://docs.microsoft.com/en-us/powershell/module/teams/set-csusercallingsettings?view=teams-ps"  target="_blank" rel="noopener"
    >Set-CsUserCallingSettings</a> or the Boss/Admin feature can do this!</p>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/get-missed-call-notifications-for-teams-call-queues-free-community-solution-cozo3bhojb7t/">
        
        
            <div class="article-image">
                <img src="/p/get-missed-call-notifications-for-teams-call-queues-free-community-solution-cozo3bhojb7t/cover.7304950aa6b85bd8562e89f20b457eab_hu_279a6c7452d3f0bf.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Get Missed Call Notifications for Teams Call Queues (Free Community Solution)"
                        data-key="/get-missed-call-notifications-for-teams-call-queues-(free-community-solution)-cozo3bhojb7t" 
                        data-hash="md5-cwSVCqa4W9hWLonyC0V&#43;qw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Get Missed Call Notifications for Teams Call Queues (Free Community Solution)</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/get-microsoft-teams-meeting-attendance-report-through-graph-api-lhpctbnzht7z/">
        
        

        <div class="article-details">
            <h2 class="article-title">Get Microsoft Teams Meeting Attendance Report Through Graph API</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/microsoft-graph-get-an-access-token-from-an-established-powershell-session-zv37e1xmxr86/">
        
        

        <div class="article-details">
            <h2 class="article-title">Microsoft Graph: Get an Access Token from a PowerShell Session</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/get-teams-user-properties-from-microsoft-graph-api-93ql20to0nr6/">
        
        
            <div class="article-image">
                <img src="/p/get-teams-user-properties-from-microsoft-graph-api-93ql20to0nr6/cover.192ae10f8fb80b26c8d8dcebee673c6d_hu_a9a3ff452bdadaf6.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Get Teams User Properties (incl. Phone Number) from Microsoft Graph"
                        data-key="/get-teams-user-properties-from-microsoft-graph-api-93ql20to0nr6" 
                        data-hash="md5-GSrhD4&#43;4CybI2Nzr7mc8bQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Get Teams User Properties (incl. Phone Number) from Microsoft Graph</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/powershell-script-example-upload-small-files-via-microsoft-graph-z45tbunyoa85/">
        
        

        <div class="article-details">
            <h2 class="article-title">PowerShell Script Example: Upload Small Files to SharePoint via Microsoft Graph</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "heusser-pro" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2022 - 
        
        2025 HEUSSER.PRO
    </section>
    
    <section class="powerby">
        
            Hosted on GitHub Pages <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.30.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>

