<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Teams Call Queues received a (quiet) feature update and now support text to speech and audio file greetings in exception handlings. I&#39;ve updated the M365 Call Flow Visualizer to properly output these changes in the diagrams.'>
<title>Teams Call Queues now Support Greetings in Exception Handlings</title>

<link rel='canonical' href='https://heusser.pro/p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/'>

<link rel="stylesheet" href="/scss/style.min.abbd69b2908fdfcd5179898beaafd374514a86538d81639ddd2c58c06ae54e40.css"><meta property='og:title' content='Teams Call Queues now Support Greetings in Exception Handlings'>
<meta property='og:description' content='Teams Call Queues received a (quiet) feature update and now support text to speech and audio file greetings in exception handlings. I&#39;ve updated the M365 Call Flow Visualizer to properly output these changes in the diagrams.'>
<meta property='og:url' content='https://heusser.pro/p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/'>
<meta property='og:site_name' content='HEUSSER.PRO'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2024-05-01T15:31:57&#43;00:00'/><meta property='article:modified_time' content='2024-05-01T15:31:57&#43;00:00'/><meta property='og:image' content='https://heusser.pro/p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/cover.png' />
<meta name="twitter:title" content="Teams Call Queues now Support Greetings in Exception Handlings">
<meta name="twitter:description" content="Teams Call Queues received a (quiet) feature update and now support text to speech and audio file greetings in exception handlings. I&#39;ve updated the M365 Call Flow Visualizer to properly output these changes in the diagrams."><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://heusser.pro/p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/cover.png' />
    <link rel="shortcut icon" href="/favicon.png" />

    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "kozb6q2xjn");
    </script>    

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hud7e6b3cccc21b12ddf35b72eb655064d_860969_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ðŸ«¡</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">HEUSSER.PRO</a></h1>
            <h2 class="site-description">Martin Heusser | M365 Apps &amp; Services MVP</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/mozziemozz'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://x.com/@mozzeph'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about-me/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About Me</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/imprint/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-info-circle" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0" /><path d="M12 9h.01" /><path d="M11 12h1v4h1" /></svg>
                
                <span>Imprint</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#how-it-was-before">How It Was Before</a></li>
    <li><a href="#whats-changed">What&rsquo;s Changed?</a></li>
    <li><a href="#powershell-vs-teams-admin-center">PowerShell vs Teams Admin Center</a></li>
    <li><a href="#summary">Summary</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/">
                <img src="/p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/cover_hu0960decf7c811e42aa4df3a03c293dd4_87434_800x0_resize_box_3.png"
                        srcset="/p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/cover_hu0960decf7c811e42aa4df3a03c293dd4_87434_800x0_resize_box_3.png 800w, /p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/cover_hu0960decf7c811e42aa4df3a03c293dd4_87434_1600x0_resize_box_3.png 1600w"
                        width="800" 
                        height="202" 
                        loading="lazy"
                        alt="Featured image of post Teams Call Queues now Support Greetings in Exception Handlings" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/microsoft-teams/" >
                Microsoft Teams
            </a>
        
            <a href="/categories/teams-admin-center/" >
                Teams Admin Center
            </a>
        
            <a href="/categories/call-flow/" >
                Call Flow
            </a>
        
            <a href="/categories/powershell/" style="background-color: #141e2c; color: #fff;">
                PowerShell
            </a>
        
            <a href="/categories/call-flow-visualizer/" >
                Call Flow Visualizer
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/">Teams Call Queues now Support Greetings in Exception Handlings</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            Teams Call Queues received a (quiet) feature update and now support text to speech and audio file greetings in exception handlings. I&#39;ve updated the M365 Call Flow Visualizer to properly output these changes in the diagrams.
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">May 01, 2024</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    3 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="how-it-was-before">How It Was Before</h2>
<p>I noticed a whole lot of new properties returned by <code>Get-CsCallQueue</code> quite a while ago but somehow I completely missed that Microsoft has now added this feature in Teams Admin Center. Before this was rolled out, the only way to play a message before disconnecting when a call timed out, when there were too many concurrent calls or when no agents were available in a call queue, you had to forward the call to an additional auto attendant which only played the message and then disconnected the call.</p>
<p>A call flow which had no message looked like this. The call disconnected without any message.</p>
<p><img src="/p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/PS_Test_EV_Enabled_CQ_CallFlow.png"
	width="2110"
	height="3840"
	srcset="/p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/PS_Test_EV_Enabled_CQ_CallFlow_hu9a41712bea05c105cce00e8ee4d47d78_457578_480x0_resize_box_3.png 480w, /p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/PS_Test_EV_Enabled_CQ_CallFlow_hu9a41712bea05c105cce00e8ee4d47d78_457578_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="No Disconnect Message"
	
	
		class="gallery-image" 
		data-flex-grow="54"
		data-flex-basis="131px"
	
></p>
<p>A call flow using the workaround with an additional auto attendant looked like this. The call had to be forwarded to an auto attendant so that a message could be played back before disconnecting the call.</p>
<p><img src="/p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/PS_Test_EV_Enabled_CQ_CallFlow_Disconnect_AA.png"
	width="1947"
	height="3840"
	srcset="/p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/PS_Test_EV_Enabled_CQ_CallFlow_Disconnect_AA_hud8799100385cd5077c67ca0694550ab6_430101_480x0_resize_box_3.png 480w, /p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/PS_Test_EV_Enabled_CQ_CallFlow_Disconnect_AA_hud8799100385cd5077c67ca0694550ab6_430101_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="Disconnect Message on Auto Attendant"
	
	
		class="gallery-image" 
		data-flex-grow="50"
		data-flex-basis="121px"
	
></p>
<p>While it wasn&rsquo;t very hard to build something like that, it certainly required more time and added unnecessary complexity to otherwise relatively simple call flows.</p>
<h2 id="whats-changed">What&rsquo;s Changed?</h2>
<p>With the recently added functionality, it&rsquo;s now possible to configure greetings on call queues in exception handling actions. At the time of writing this blog post it&rsquo;s possible to configure a greeting for <strong>Disconnect</strong> and <strong>Redirect to External Phone Number</strong> or <strong>Redirect to Voice App</strong>.</p>
<p><img src="/p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/image.png"
	width="1992"
	height="826"
	srcset="/p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/image_hu7bd3392f7dd1ded220a4677d786033d2_57355_480x0_resize_box_3.png 480w, /p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/image_hu7bd3392f7dd1ded220a4677d786033d2_57355_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="Greeting on Disconnect"
	
	
		class="gallery-image" 
		data-flex-grow="241"
		data-flex-basis="578px"
	
> <img src="/p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/image-1.png"
	width="1398"
	height="655"
	srcset="/p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/image-1_hua1d7e441c45ba0c67456bb739528297b_43345_480x0_resize_box_3.png 480w, /p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/image-1_hua1d7e441c45ba0c67456bb739528297b_43345_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="Greeting for Redirect to Phone Number"
	
	
		class="gallery-image" 
		data-flex-grow="213"
		data-flex-basis="512px"
	
> <img src="/p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/image-2.png"
	width="1412"
	height="960"
	srcset="/p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/image-2_hu4525acce454994458fa05bf3227e074c_75762_480x0_resize_box_3.png 480w, /p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/image-2_hu4525acce454994458fa05bf3227e074c_75762_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="Greeting for Redirect to Voice App"
	
	
		class="gallery-image" 
		data-flex-grow="147"
		data-flex-basis="353px"
	
></p>
<p>I&rsquo;ve already added support for these new configuration options to the <a class="link" href="https://github.com/mozziemozz/M365CallFlowVisualizer"  target="_blank" rel="noopener"
    >M365 Call Flow Visualizer</a>. In this demo call flow I&rsquo;m just using text to speech greetings but of course it also works for audio files including exporting them to disk. This is how it looks now.</p>
<p><img src="/p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/PS_Test_EV_Enabled_CQ_CallFlow_New_Greetings.png"
	width="1978"
	height="3840"
	srcset="/p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/PS_Test_EV_Enabled_CQ_CallFlow_New_Greetings_hu931dbaf6700091893deebd0799b3ad4d_472003_480x0_resize_box_3.png 480w, /p/teams-call-queues-now-support-greetings-in-exception-handlings-1ye1avs43jps/PS_Test_EV_Enabled_CQ_CallFlow_New_Greetings_hu931dbaf6700091893deebd0799b3ad4d_472003_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="Greetings are configured on call queue directly"
	
	
		class="gallery-image" 
		data-flex-grow="51"
		data-flex-basis="123px"
	
></p>
<p>As you can see, the greetings are now configured directly on the call queue and there&rsquo;s no need to deploy and manage additional auto attendants anymore. The greeting options for redirect to shared voicemail are unchanged. This can be seen on the <strong>PS Test EV Enabled On Call CQ</strong>.</p>
<h2 id="powershell-vs-teams-admin-center">PowerShell vs Teams Admin Center</h2>
<p>Teams Admin Center doesn&rsquo;t support configuring a greeting if the call is being forwarded to another Teams user (person in organization) or a personal voicemail. However, the available properties which are returned in <code>Get-CsCallQueue</code> hint that support for greetings before a call is forwarded to a person might be coming soon too.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nv">$cq</span> <span class="p">=</span> <span class="nb">Get-CsCallQueue</span> <span class="n">-Identity</span> <span class="nv">$cq</span><span class="p">.</span><span class="py">Identity</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">PS </span><span class="n">V:</span><span class="p">\</span><span class="n">GitHub</span><span class="p">\</span><span class="n">M365CallFlowVisualizer</span><span class="p">&gt;</span> <span class="nv">$cq</span> <span class="p">|</span> <span class="nb">fl </span><span class="p">*</span><span class="n">person</span><span class="p">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">OverflowRedirectPersonAudioFilePrompt</span>         <span class="err">:</span> 
</span></span><span class="line"><span class="cl"><span class="n">OverflowRedirectPersonAudioFilePromptFileName</span> <span class="err">:</span> 
</span></span><span class="line"><span class="cl"><span class="n">OverflowRedirectPersonTextToSpeechPrompt</span>      <span class="err">:</span> 
</span></span><span class="line"><span class="cl"><span class="n">TimeoutRedirectPersonAudioFilePrompt</span>          <span class="err">:</span> 
</span></span><span class="line"><span class="cl"><span class="n">TimeoutRedirectPersonAudioFilePromptFileName</span>  <span class="err">:</span> 
</span></span><span class="line"><span class="cl"><span class="n">TimeoutRedirectPersonTextToSpeechPrompt</span>       <span class="err">:</span> 
</span></span><span class="line"><span class="cl"><span class="n">NoAgentRedirectPersonAudioFilePrompt</span>          <span class="err">:</span> 
</span></span><span class="line"><span class="cl"><span class="n">NoAgentRedirectPersonAudioFilePromptFileName</span>  <span class="err">:</span> 
</span></span><span class="line"><span class="cl"><span class="n">NoAgentRedirectPersonTextToSpeechPrompt</span>       <span class="err">:</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>I wouldn&rsquo;t be me unless I tested this. Using <code>Set-CsCallQueue -Identity $cq.Identity -OverflowRedirectPersonTextToSpeechPrompt &quot;Test overflow redirect to person greeting&quot;</code> I was able to configure a greeting before the call was forwarded to the specified Teams user. A quick test call to the queue successfully played back the message before the call was forwarded to the Teams user. <strong>But</strong> when I updated the call queue in TAC again, the greeting was deleted (as expected) from the queue. I strongly recommend not to configure a greeting before redirecting to a person until the feature is officially available in Teams Admin Center. Otherwise, you can only update the queue through PS until Microsoft has added the feature to TAC as well. Because of that, I also didn&rsquo;t include this in the Visualizer yet.</p>
<h2 id="summary">Summary</h2>
<p>I haven&rsquo;t seen anybody talk about this new feature online before so I thought that it would be worth sharing. And of course I also wanted to share that the M365 Call Flow Visualizer has been updated to display all configured greetings accurately. I hope you like the new feature and that the Visualizer will help you to get your documentation up to speed quickly.</p>
<p>If you want to learn how to download existing audio files from call queues through TAC or PowerShell without the M365 Call Flow Visualizer, you can check out <a class="link" href="/p/download-existing-audio-files-from-teams-admin-center-1839230eadb0" >this</a> post.</p>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/advanced-teams-auto-attendant-troubleshooting-2b6ec32fc9cb/">
        
        

        <div class="article-details">
            <h2 class="article-title">Advanced Teams Auto Attendant Troubleshooting</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/how-to-validate-phone-number-assignments-in-teams-in-bulk-8a0909c7b5f5/">
        
        

        <div class="article-details">
            <h2 class="article-title">How to Validate Phone Number Assignments in Teams (in Bulk)</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/prettify-and-sync-teams-phone-numbers-to-azure-ad-e973755f83d5/">
        
        

        <div class="article-details">
            <h2 class="article-title">Prettify and Sync Teams Phone Numbers to Azure AD</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/manage-microsoft-teams-call-queues-with-powershell-force-sync-9919e2939552/">
        
        

        <div class="article-details">
            <h2 class="article-title">Manage Microsoft Teams Call Queues with PowerShell (Force-Sync)</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/automatically-notify-users-to-update-teams-holidays-for-next-year-cb1f6f9c6471/">
        
        

        <div class="article-details">
            <h2 class="article-title">Automatically Notify Users to Update Teams Holidays for Next Year</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "heusser-pro" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2022 - 
        
        2024 HEUSSER.PRO
    </section>
    
    <section class="powerby">
        
            Hosted on GitHub Pages <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.21.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>

